<!doctype html>
<html>
  <head charset="utf-8">
    <title>WebSocket chat</title>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
    <script type="text/javascript">
      function enter() {
        var where = location.protocol + '//' + document.domain + ':' + location.port;

        socket = io.connect(where);
        socket.on('message', function(msg) {
          var text = document.getElementById('messages');
          text.value += msg.data + '\n';
          console.log('received(' + msg + ');');
        });
      }

      function send(msg) {
        console.log('send(' + msg + ');');
        socket.emit('message', {data: msg})
      }

      function submitMessage() {
        var field = document.getElementById('message');
        var text = field.value;

        console.log('submitMessage();');
        send(text);
        field.value = '';
        return false;
      }
    </script>
  </head>
  <body onload="enter()">
    <textarea readonly wrap="soft" id="messages"></textarea>
    <form>
       <input type="text" id="message">
       <input type="button" value="Отправить" onclick="submitMessage()">
    </form>
  </body>
</html>

